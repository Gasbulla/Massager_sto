<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pagination</title>
</head>
<body>
<form id="user_data">
    <label for="username">Email: </label>
    <input id="username" value="user1@mail.ru" placeholder="user1@mail.ru">
    <label for="password">Password: </label>
    <input id="password" value="user1" placeholder="user1">
    <button name="send_user_data" type="submit" onclick="send(event)">Authorization</button>
</form>
<br>
<labe>Token is: <br></labe>
<span name="token">token <br></span>
<form id="user_data">
    <label for="url_pagination">Pagination URL: </label>
    <input id="url_pagination" value="localhost:8091/api/user/vote" placeholder="localhost:8091/api/user/vote">
</form>
<div id="pagination_objects"></div>
<div id="navigation"></div>
<script src="/js/getPagination.js"></script>
<script>
    let button = document.querySelector("button[name=send_user_data]");

    n = document.querySelector("div[name=navigation]");
    
    getPagination.token = await getTokenByUser();
    

    async function getTokenByUser(event){
        if(event != null) {
            event.preventDefault();
        }
        token = await getToken(
            {
                "username": document.querySelector("#username").value,
                "password": document.querySelector("#password").value
            }
        )
        document.querySelector("span[name=token]").innerHTML = token;
        getPagination.token = token;
        return token;
    }

    async function getToken(user) {
        console.log(user);
        let token = "";
        await fetch("http://localhost:8091/api/auth/token", {
            method: "POST",
            headers: {
                "Content-type": "application/json; charset=utf-8"
            },
            body: JSON.stringify(user)
        })
            .then(data => data.json())
            .then(resp => {
                token += "Bearer " + resp.token;
            })
        return token;
    }
</script>
</body>
</html>